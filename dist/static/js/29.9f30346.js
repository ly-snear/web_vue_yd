(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{365:function(t,e,a){"use strict";a.r(e);var s=a(832),n=a(507);for(var i in n)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return n[t]}))}(i);a(833);var r=a(16),o=Object(r.a)(n.default,s.render,s.staticRenderFns,!1,null,"063c345a",null);e.default=o.exports},507:function(t,e,a){"use strict";a.r(e);var s=a(508),n=a.n(s);for(var i in s)["default"].indexOf(i)<0&&function(t){a.d(e,t,(function(){return s[t]}))}(i);e.default=n.a},508:function(t,e,a){"use strict";(function(t,a,s,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={data:function(){return{year:{selects:[],now:0},step:{selects:[],now:0},clss:{selects:[],now:0},room:{selects:[],now:0},opened:!1,disabled:!0,it:null,data0:null,data1:null,array0:[],array1:[]}},created:function(){var e=this;this.year=t.getYear(),this.step=t.getStep(),this.clss=t.getClss(this.year.now),a.get("/room/list",{idSchool:s.get("user").idSchool}).then((function(t){if(t.ok){var a=[];t.body.forEach((function(t){a.push({title:t.name,key:t.id})})),e.room.selects=a,e.data0=t.body}}))},methods:{select0:function(e){var s=this;this.it=e,e.idStudent?t.confirm(this,"确定删除该座位 ？",(function(t){s.loading=!0,t.close(),e.id&&a.post("/seat/delete",{id:e.id}).then((function(t){s.loading=!1,t.ok&&n.$Message.success("删除成功")})),e.idStudent=null,e.exStudent=null,e.exAvatar=null,s.$forceUpdate()})):(this.opened=!0,this.setModal())},select1:function(t){var e=this;this.opened=!1,a.post("/seat/create",{group:this.it.group,index:this.it.index,semester:this.step.now,idClass:this.clss.now,idRoom:this.room.now,idStudent:t.id,exStudent:t.name,exAvatar:t.avatar}).then((function(t){if(e.loading=!1,t.ok){var a=e.array0[t.body.group-1].list[t.body.index-1];a.id=t.body.id,a.idStudent=t.body.idStudent,a.exStudent=t.body.exStudent,a.exAvatar=t.body.exAvatar,e.$forceUpdate(),n.$Message.success("设置成功")}}))},setModal:function(){var t=this,e=[];this.data1.forEach((function(a){var s=!0;t.array0.forEach((function(t){t.list.forEach((function(t){a.id==t.idStudent&&(s=!1)}))})),s&&e.push(a)}));for(var a=0;a<e.length;a+=5){for(var s=[],n=a;n<a+5&&n<e.length;n++)s.push(e[n]);e.push({key:"k"+a,list:s})}this.array1=e},changeRoom:function(){for(var t=this,e=this.data0.findIndex((function(e){return e.id==t.room.now})),s=[],n=0;n<this.data0[e].group;n++){for(var i=[],r=0;r<8;r++)i.push({group:n+1,index:r+1,idStudent:null,exStudent:null,exAvatar:null});s.push({key:"k"+n,list:i})}this.array0=s,a.get("/seat/list",{semester:this.step.now,idClass:this.clss.now}).then((function(e){e.ok&&(e.body.forEach((function(e){var a=t.array0[e.group-1].list[e.index-1];a.id=e.id,a.idStudent=e.idStudent,a.exStudent=e.exStudent,a.exAvatar=e.exAvatar})),t.$forceUpdate())}))},changeClss:function(){var t=this;a.get("/student/list",{idYear:this.year.now,idClass:this.clss.now}).then((function(e){e.ok&&(e.body.forEach((function(t){t.avatar||(t.avatar=t.male?"/static/images/avatar-male-96.png":"/static/images/avatar-female-96.png")})),t.data1=e.body,t.room.now=0,t.array0=[],t.array1=[])}))},remove:function(){}}};e.default=i}).call(this,a(107).default,a(153).default,a(108),a(69))},649:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.staticRenderFns=e.render=void 0;var s=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"frame-page"},[e("div",{staticClass:"h-panel page-header"},[e("div",{staticClass:"h-panel-body"},[e("Row",{attrs:{type:"flex",space:20}},[e("Cell",{attrs:{width:4}},[e("Select",{attrs:{datas:t.year.selects,deletable:!1,disabled:""},model:{value:t.year.now,callback:function(e){t.$set(t.year,"now",e)},expression:"year.now"}})],1),t._v(" "),e("Cell",{attrs:{width:4}},[e("Select",{attrs:{datas:t.step.selects,deletable:!1,disabled:""},model:{value:t.step.now,callback:function(e){t.$set(t.step,"now",e)},expression:"step.now"}})],1),t._v(" "),e("Cell",{attrs:{width:4}},[e("Select",{attrs:{datas:t.clss.selects,deletable:!1,placeholder:"选择班级"},on:{change:t.changeClss},model:{value:t.clss.now,callback:function(e){t.$set(t.clss,"now",e)},expression:"clss.now"}})],1),t._v(" "),t.clss.now>0?e("Cell",{attrs:{width:4}},[e("Select",{attrs:{datas:t.room.selects,deletable:!1,placeholder:"选择教室"},on:{change:t.changeRoom},model:{value:t.room.now,callback:function(e){t.$set(t.room,"now",e)},expression:"room.now"}})],1):t._e()],1)],1)]),t._v(" "),t._l(t.array0,(function(a,s){return e("div",{key:a.key,staticClass:"h-panel page-header"},[e("div",{staticClass:"h-panel-body"},[e("div",{staticClass:"title"},[t._v("第 "+t._s(s+1)+" 组")]),t._v(" "),e("Row",{attrs:{space:30}},t._l(a.list,(function(a){return e("Cell",{key:a.id,attrs:{width:2,value:a}},[e("div",{staticClass:"click item",on:{click:function(e){return t.select0(a)}}},[e("div",{staticClass:"center"},[t._v(t._s(a.index)+" 号")]),t._v(" "),e("Avatar",{directives:[{name:"width",rawName:"v-width",value:64,expression:"64"}],staticClass:"top",attrs:{width:64,distance:0,src:a.exAvatar||"/static/images/add-60.png"}}),t._v(" "),e("div",{staticClass:"center top"},[t._v(t._s(a.exStudent))])],1)])})),1)],1)])}))],2),t._v(" "),e("Modal",{attrs:{type:"drawer-right"},model:{value:t.opened,callback:function(e){t.opened=e},expression:"opened"}},[e("div",{staticClass:"model-right"},[e("div",{staticClass:"title"},[t._v("选择学生")]),t._v(" "),t._l(t.array1,(function(a){return e("Row",{key:a.key,attrs:{space:30}},t._l(a.list,(function(a){return e("Cell",{key:a.id,attrs:{width:4,value:a}},[e("div",{staticClass:"click item",on:{click:function(e){return t.select1(a)}}},[e("Avatar",{directives:[{name:"width",rawName:"v-width",value:64,expression:"64"}],staticClass:"avatar top",attrs:{width:64,distance:0,src:a.avatar}}),t._v(" "),e("div",{staticClass:"center"},[t._v(t._s(a.name))])],1)])})),1)}))],2)])],1)};e.render=s;e.staticRenderFns=[],s._withStripped=!0},650:function(t,e,a){},832:function(t,e,a){"use strict";var s=a(649);a.o(s,"render")&&a.d(e,"render",(function(){return s.render})),a.o(s,"staticRenderFns")&&a.d(e,"staticRenderFns",(function(){return s.staticRenderFns}))},833:function(t,e,a){"use strict";a(650)}}]);